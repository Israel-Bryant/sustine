<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<!--
    SUPORTE CASAS PEDRO - Manutenção de Planilhas
    UI Futurística v3.0
-->

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.casaspedro.suporte.controllers.PlanilhaController"
            styleClass="root"
            prefWidth="1280" prefHeight="800"
            stylesheets="@../css/theme.css, @../css/planilha.css">

    <!-- HEADER -->
    <top>
        <HBox styleClass="page-header" alignment="CENTER_LEFT" spacing="24">
            <Button styleClass="btn-back" onAction="#onVoltar">
                <graphic>
                    <HBox alignment="CENTER" spacing="6">
                        <FontIcon iconLiteral="fas-arrow-left" iconSize="12"/>
                        <Label text="Voltar"/>
                    </HBox>
                </graphic>
            </Button>
            <VBox spacing="2">
                <HBox alignment="CENTER_LEFT" spacing="8">
                    <FontIcon iconLiteral="fas-table" iconSize="18" styleClass="page-icon"/>
                    <Label text="Manutenção de Planilhas" styleClass="page-title"/>
                </HBox>
                <Label text="Repara arquivos Excel bloqueados ou corrompidos" styleClass="page-subtitle"/>
            </VBox>
        </HBox>
    </top>

    <!-- CONTENT -->
    <center>
        <VBox alignment="TOP_CENTER" styleClass="main-area">
            <padding>
                <Insets top="40" right="64" bottom="40" left="64"/>
            </padding>
            
            <!-- DROP ZONE -->
            <VBox fx:id="dropZone" styleClass="drop-zone" alignment="CENTER" spacing="16"
                  prefWidth="600" prefHeight="200">
                <FontIcon fx:id="dropZoneIcon" iconLiteral="fas-cloud-download-alt" iconSize="48" styleClass="drop-zone-icon"/>
                <Label fx:id="dropZoneLabel" text="Arraste uma planilha aqui" styleClass="drop-zone-text"/>
                <Label fx:id="arquivoNomeLabel" text="" styleClass="arquivo-nome" visible="false" managed="false"/>
                <Button fx:id="btnSelecionar" styleClass="btn-secondary" onAction="#onSelecionarArquivo">
                    <graphic>
                        <HBox alignment="CENTER" spacing="8">
                            <FontIcon iconLiteral="fas-folder-open" iconSize="14"/>
                            <Label text="Selecionar Arquivo"/>
                        </HBox>
                    </graphic>
                </Button>
            </VBox>
            
            <!-- BOTÕES -->
            <HBox alignment="CENTER" spacing="16">
                <padding>
                    <Insets top="24"/>
                </padding>
                <Button fx:id="btnReparar" styleClass="btn-primary" onAction="#onRepararPlanilha" disable="true">
                    <graphic>
                        <HBox alignment="CENTER" spacing="8">
                            <FontIcon iconLiteral="fas-wrench" iconSize="14"/>
                            <Label text="Reparar Planilha" style="-fx-text-fill: white;"/>
                        </HBox>
                    </graphic>
                </Button>
                <Button fx:id="btnLimpar" styleClass="btn-secondary" onAction="#onLimpar" disable="true">
                    <graphic>
                        <HBox alignment="CENTER" spacing="8">
                            <FontIcon iconLiteral="fas-trash-alt" iconSize="14"/>
                            <Label text="Limpar"/>
                        </HBox>
                    </graphic>
                </Button>
            </HBox>
            
            <!-- PROGRESS -->
            <VBox alignment="CENTER" spacing="10" styleClass="progress-area">
                <padding>
                    <Insets top="16"/>
                </padding>
                <ProgressBar fx:id="progressBar" prefWidth="500" visible="false" managed="false"/>
                <Label fx:id="progressLabel" text="0%" styleClass="progress-label" visible="false" managed="false"/>
            </VBox>
            
            <!-- RESULTADO -->
            <HBox fx:id="resultadoBox" alignment="CENTER" spacing="14" styleClass="resultado-box" 
                  visible="false" managed="false">
                <padding>
                    <Insets top="16"/>
                </padding>
                <FontIcon fx:id="resultadoIcon" iconLiteral="fas-check-circle" iconSize="22" styleClass="resultado-icon"/>
                <Label fx:id="resultadoTexto" text="Resultado" styleClass="resultado-texto"/>
            </HBox>
            
            <!-- LOG -->
            <VBox spacing="10" VBox.vgrow="ALWAYS">
                <padding>
                    <Insets top="24"/>
                </padding>
                <HBox alignment="CENTER_LEFT" spacing="8">
                    <FontIcon iconLiteral="fas-clipboard-list" iconSize="14" style="-fx-fill: #94A3B8;"/>
                    <Label text="Log de Execução" styleClass="log-title"/>
                </HBox>
                <TextArea fx:id="logArea" styleClass="log-area" 
                          editable="false" wrapText="true"
                          prefHeight="180" VBox.vgrow="ALWAYS"/>
            </VBox>
            
        </VBox>
    </center>

    <!-- FOOTER -->
    <bottom>
        <HBox styleClass="page-footer" alignment="CENTER" spacing="8">
            <FontIcon iconLiteral="fas-lightbulb" iconSize="12" style="-fx-fill: #64748B;"/>
            <Label text="Esta ferramenta fecha o Excel, remove bloqueios e limpa cache do Office" styleClass="footer-info"/>
        </HBox>
    </bottom>

</BorderPane>
